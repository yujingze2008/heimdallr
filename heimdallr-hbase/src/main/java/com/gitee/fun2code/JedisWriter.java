package com.gitee.fun2code;

import redis.clients.jedis.HostAndPort;
import redis.clients.jedis.JedisCluster;
import redis.clients.jedis.JedisPoolConfig;

import java.util.HashSet;
import java.util.Random;
import java.util.Set;

/**
 * Created by Administrator on 2019/5/30.
 */
public class JedisWriter implements Runnable {

    public static void main(String[] args) {
        for (int i = 0; i < 10; i++) {
            new Thread(new JedisWriter()).start();
        }
    }

    static JedisCluster jedisCluster = null;

    static {
        Set<HostAndPort> jedisClusterNode = new HashSet<HostAndPort>();
        jedisClusterNode.add(new HostAndPort("192.168.243.131", 7000));
        jedisClusterNode.add(new HostAndPort("192.168.243.131", 7001));
        jedisClusterNode.add(new HostAndPort("192.168.243.132", 7002));
        jedisClusterNode.add(new HostAndPort("192.168.243.132", 7003));
        jedisClusterNode.add(new HostAndPort("192.168.243.133", 7004));
        jedisClusterNode.add(new HostAndPort("192.168.243.133", 7005));
        JedisPoolConfig config = new JedisPoolConfig();
        config.setMaxTotal(2);//设置最大连接数
        config.setMaxIdle(2);//设置最大空闲连接
        jedisCluster = new JedisCluster(jedisClusterNode, 5000, 10);
    }

    @Override
    public void run() {
        for (; ; ) {
            String key = keys[new Random().nextInt(keys.length - 1)];
            //System.out.println("write:"+key);
            jedisCluster.set(System.currentTimeMillis() + "", bigStr);
            jedisCluster.hset("myhash", String.valueOf(System.currentTimeMillis()), bigStr);
        }
    }

    static final String bigStr = "Thread-11559147046382" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146818286" +
            "Thread-81559146817022" +
            "Thread-61559146813719" +
            "Thread-81559146834861" +
            "Thread-91559146836370" +
            "Thread-91559146808554" +
            "Thread-31559146825596" +
            "Thread-81559146810322" +
            "Thread-41559146919153" +
            "Thread-41559146914757" +
            "Thread-41559146838869" +
            "Thread-91559146829574" +
            "Thread-11559146834913" +
            "Thread-71559146909345" +
            "Thread-61559146929476" +
            "Thread-81559146834536" +
            "Thread-10155914692939" +
            "Thread-10155914682154" +
            "Thread-11559147070504" +
            "Thread-41559146914404" +
            "Thread-41559146830190" +
            "Thread-91559146812731" +
            "Thread-11559146908332" +
            "Thread-21559146834952" +
            "Thread-10155914682442" +
            "Thread-10155914705856" +
            "Thread-31559146930209" +
            "Thread-81559147066641" +
            "Thread-21559146819920" +
            "Thread-91559146808970" +
            "Thread-31559146810671" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-11559146823960115591468239601155914682396011559146823960115591468239601155914682396011559146823960" +
            "Thread-91559146815814" +
            "Thread-91559147012382";

    static final String[] keys = new String[]{"Thread-11559147046382",
            "Thread-11559146823960",
            "Thread-81559146811835",
            "Thread-31559146806596",
            "Thread-71559146838056",
            "Thread-11559147035107",
            "Thread-51559147048406",
            "Thread-61559146810278",
            "Thread-11559146812175",
            "Thread-61559146908448",
            "Thread-51559146825830",
            "Thread-51559146811004",
            "Thread-11559146806409",
            "Thread-91559146815814",
            "Thread-11559146818286",
            "Thread-81559146817022",
            "Thread-61559146813719",
            "Thread-81559146834861",
            "Thread-91559146836370",
            "Thread-91559146808554",
            "Thread-31559146825596",
            "Thread-81559146810322",
            "Thread-41559146919153",
            "Thread-41559146914757",
            "Thread-41559146838869",
            "Thread-91559146829574",
            "Thread-11559146834913",
            "Thread-71559146909345",
            "Thread-61559146929476",
            "Thread-81559146834536",
            "Thread-10155914692939",
            "Thread-10155914682154",
            "Thread-11559147070504",
            "Thread-41559146914404",
            "Thread-41559146830190",
            "Thread-91559146812731",
            "Thread-11559146908332",
            "Thread-21559146834952",
            "Thread-10155914682442",
            "Thread-10155914705856",
            "Thread-31559146930209",
            "Thread-81559147066641",
            "Thread-21559146819920",
            "Thread-91559146808970",
            "Thread-31559146810671",
            "Thread-91559147012382"};

}
